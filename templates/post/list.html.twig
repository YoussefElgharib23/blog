{% extends 'base.html.twig' %}

{% block title 'List posts' %}

{% block body %}
    <style>
        @keyframes changeOpacityImg {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .img, img {
            opacity: 0;
            animation: changeOpacityImg;
            animation-delay: .5s;
            animation-duration: 2s;
            animation-fill-mode: forwards;
            transition: opacity .5s ease-in-out;
        }

        .actions-article-admin {
            transform: translateY(13px);
            opacity: 0;
            transition: opacity .2s ease-in-out, transform .4s ease-in-out;
            z-index: 1000;
        }
        .o-g {
            opacity: 0;
            transition: opacity .2s ease-in-out;
            position: absolute;
            background-image: linear-gradient(180Deg, #0000000f, #93939357);;
            z-index: 100;
            height: 100%;
        }
    </style>
    {% set defaultImage = 'https://images.pexels.com/photos/5014775/pexels-photo-5014775.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940' %}
    {{ include('layouts/_dashboard_navbar.html.twig') }}
    <div class="container">
        {% if not posts | length > 0 and post is null %}
            <div class="alert alert-danger text-center" role="alert">Sorry ! No posts yet ! <br> You can create new one bu the following
                <a href="{{ path('app_post_create') }}" class="link-c" style="text-decoration: underline">link</a></div>
        {% else %}
            <div class="row jumbotron">
                <div class="col-md-6">
                <span class="img rounded"
                      style="background-image: url('{{ post.imageLink ?? defaultImage }}');
                      width: 100%; height: 320px; display: block; background-size: cover">
                </span>
                </div>
                <div class="col-md-6">
                    <div>
                        <a href="{{ path('app_post_app_post_edit', {'id': post.id}) }}" class="btn btn-outline-primary btn-sm">Edit</a>
                        <a class="btn btn-outline-warning btn-sm">Delete</a>
                        {{ include('post/_post_delete.html.twig') }}
                    </div>
                    <div class="article-info w-100 mt-2">
                        <small><span style="color: #fe4f4f">CategoryPost</span> - {{ post.createdAt | date('M, d Y') }}</small>
                        <h1><a href="{{ path('app_post_show', {'id': post.id, 'slug': post.slug}) }}" class="link-c">{{ post.title }}</a></h1>
                        <p>{{ post.description }}</p>
                        <a href="" class="btn btn-outline-info btn-block">Read more</a>
                    </div>
                </div>
            </div>
            <hr>
            {% for row in posts | batch(4) %}
                <div class="row">
                    {% for post in row %}
                        <div class="col-sm-6 col-md-4 col-lg-3">
                            <div style="position: relative" class="article-image">
                                <span class="actions-article-admin" style="position: absolute; bottom: 7px; right: 9px;">
                                    <a href="{{ path('app_post_app_post_edit', {'id': post.id}) }}" class="btn btn-info btn-sm">Edit</a>
                                    <a href="#" class="btn btn-danger btn-sm" id="btn-del-js">Delete</a>
                                    {{ include('post/_post_delete.html.twig') }}
                                </span>
                                <div class="rounded o-g w-100"></div>
                                <img alt=""
                                     class="rounded img-fluid mw-100"
                                     src="{{ post.imageLink ?? defaultImage }}">
                            </div>
                            <small><span style="color: #fe4f4f">CategoryPost</span> - {{ post.createdAt | date('M, d Y') }}</small>
                            <h2 class="h6"><a href="#" class="text-decoration-none text-dark">{{ post.title | u.truncate(25, '...', false) }}</a></h2>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="alert alert-danger text-center">No other posts !</div>
            {% endfor %}
            </div>
        {% endif %}

{% endblock %}

{% block javascripts %}
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){
            $(".article-image").mouseover(function(){
                $(this).find('.actions-article-admin').css({'opacity': '1', 'transform': 'translateY(0)'});
                $(this).find('.o-g').css({'opacity': '1'});
            }).mouseleave(function(){
                $(this).find('.actions-article-admin').css({'opacity': '0', 'transform': 'translateY(5px)'});
                $(this).find('.o-g').css({'opacity': '0'});
            });
        });


        $('#btn-del-js').click(function (event) {
            event.preventDefault();
            alert('Hello');
            $('#delete-form-js').submit();
        });
    </script>
{% endblock %}